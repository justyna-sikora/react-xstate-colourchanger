{"ast":null,"code":"import _objectSpread from \"/mnt/c/users/justa/documents/assignment2/react-xstate-colourchanger/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport { send } from \"xstate\"; // SRGS parser and example (logs the results to console on page load)\n\nimport { loadGrammar } from './runparser';\nimport { parse } from './chartparser';\nimport { grammar } from './grammars/pizzaGrammar1';\nconst gram = loadGrammar(grammar);\nconst input = \"do be do be do\";\nconst prs = parse(input.split(/\\s+/), gram);\nconst result = prs.resultsForRule(gram.$root)[0];\nconsole.log(result);\nconst sayColour = send(context => ({\n  type: \"SPEAK\",\n  value: \"Repainting to \".concat(context.recResult)\n}));\n\nfunction say(text) {\n  return send(_context => ({\n    type: \"SPEAK\",\n    value: text\n  }));\n}\n\nfunction promptAndAsk(prompt) {\n  return {\n    initial: 'prompt',\n    states: {\n      prompt: {\n        entry: say(prompt),\n        on: {\n          ENDSPEECH: 'ask'\n        }\n      },\n      ask: {\n        entry: send('LISTEN')\n      }\n    }\n  };\n}\n\nconst commands = {\n  \"stop\": \"S\",\n  \"help\": \"H\"\n};\nexport const dmMachine = {\n  initial: 'init',\n  states: {\n    init: {\n      on: {\n        CLICK: 'askColourAndShape'\n      }\n    },\n    askColourAndShape: {\n      initial: 'colour',\n      on: {\n        RECOGNISED: {\n          target: 'stop',\n          cond: context => context.recResult === 'stop'\n        }\n      },\n      states: {\n        colour: _objectSpread({\n          on: {\n            RECOGNISED: [{\n              target: 'shape',\n              cond: context => !(context.recResult === 'stop')\n            }]\n          }\n        }, promptAndAsk(\"Tell me the colour\")),\n        shape: _objectSpread({\n          on: {\n            RECOGNISED: [{\n              target: '#root.dm.repaint',\n              cond: context => !(context.recResult === 'stop')\n            }]\n          }\n        }, promptAndAsk(\"Tell me the shape\"))\n      }\n    },\n    stop: {\n      entry: say(\"Ok\"),\n      always: 'init'\n    },\n    repaint: {\n      initial: 'prompt',\n      states: {\n        prompt: {\n          entry: sayColour,\n          on: {\n            ENDSPEECH: 'repaint'\n          }\n        },\n        repaint: {\n          entry: 'changeColour',\n          always: '#root.dm.askColourAndShape'\n        }\n      }\n    }\n  }\n};","map":{"version":3,"sources":["/mnt/c/users/justa/documents/assignment2/react-xstate-colourchanger/src/dmColourChanger1.ts"],"names":["send","loadGrammar","parse","grammar","gram","input","prs","split","result","resultsForRule","$root","console","log","sayColour","context","type","value","recResult","say","text","_context","promptAndAsk","prompt","initial","states","entry","on","ENDSPEECH","ask","commands","dmMachine","init","CLICK","askColourAndShape","RECOGNISED","target","cond","colour","shape","stop","always","repaint"],"mappings":"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","sourcesContent":["import { MachineConfig, send, Action } from \"xstate\";\r\n\r\n// SRGS parser and example (logs the results to console on page load)\r\nimport { loadGrammar } from './runparser'\r\nimport { parse } from './chartparser'\r\nimport { grammar } from './grammars/pizzaGrammar1'\r\n\r\nconst gram = loadGrammar(grammar)\r\nconst input = \"do be do be do\"\r\nconst prs = parse(input.split(/\\s+/), gram)\r\nconst result = prs.resultsForRule(gram.$root)[0]\r\n\r\nconsole.log(result)\r\n\r\nconst sayColour: Action<SDSContext, SDSEvent> = send((context: SDSContext) => ({\r\n    type: \"SPEAK\", value: `Repainting to ${context.recResult}`\r\n}))\r\n\r\nfunction say(text: string): Action<SDSContext, SDSEvent> {\r\n    return send((_context: SDSContext) => ({ type: \"SPEAK\", value: text }))\r\n}\r\n\r\nfunction promptAndAsk(prompt: string): MachineConfig<SDSContext, any, SDSEvent> {\r\n    return ({\r\n        initial: 'prompt',\r\n        states: {\r\n            prompt: {\r\n                entry: say(prompt),\r\n                on: { ENDSPEECH: 'ask' }\r\n            },\r\n            ask: {\r\n                entry: send('LISTEN'),\r\n            },\r\n        }\r\n    })\r\n}\r\n\r\nconst commands = {\"stop\": \"S\", \"help\": \"H\"}\r\n\r\nexport const dmMachine: MachineConfig<SDSContext, any, SDSEvent> = ({\r\n    initial: 'init',\r\n    states: {\r\n        init: {\r\n            on: {\r\n                CLICK: 'askColourAndShape'\r\n            }\r\n        },\r\n        askColourAndShape: {\r\n            initial: 'colour',\r\n            on: {RECOGNISED: \r\n                    { target: 'stop', \r\n                    cond: (context) => context.recResult === 'stop' },},\r\n            states: {\r\n                colour: {\r\n                    on: {\r\n                        RECOGNISED: [\r\n                            {target: 'shape',\r\n                            cond: (context) => !(context.recResult === 'stop')}]\r\n                    },\r\n                         \r\n                    ...promptAndAsk(\"Tell me the colour\")\r\n                },\r\n                shape: {\r\n                    on: {\r\n                        RECOGNISED: [\r\n                            {target: '#root.dm.repaint',\r\n                            cond: (context) => !(context.recResult === 'stop')}]\r\n                    },\r\n                    ...promptAndAsk(\"Tell me the shape\")\r\n                }}\r\n            },\r\n        stop: {\r\n            entry: say(\"Ok\"),\r\n            always: 'init'\r\n        },\r\n        repaint: {\r\n            initial: 'prompt',\r\n            states: {\r\n                prompt: {\r\n                    entry: sayColour,\r\n                    on: { ENDSPEECH: 'repaint' }\r\n                },\r\n                repaint: {\r\n                    entry: 'changeColour',\r\n                    always: '#root.dm.askColourAndShape'\r\n                }\r\n            }\r\n        }\r\n    }\r\n})"]},"metadata":{},"sourceType":"module"}