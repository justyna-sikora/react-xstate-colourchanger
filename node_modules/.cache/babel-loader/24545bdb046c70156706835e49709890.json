{"ast":null,"code":"import { send, actions } from \"xstate\";\nconst cancel = actions.cancel; // SRGS parser and example (logs the results to console on page load)\n\nimport { loadGrammar } from './runparser';\nimport { parse } from './chartparser';\nimport { grammar } from './grammars/homeGrammar'; //import { cancel } from \"xstate/lib/actionTypes\";\n\nconst gram = loadGrammar(grammar); //const input = \"turn the A C off\"\n//const prs = parse(input.split(/\\s+/), gram)\n\nconst result = parse(\"turn the A C off\".split(/\\s+/), gram).resultsForRule(gram.$root)[0];\nconsole.log(result);\nconsole.log(gram);\nconst sayColour = send(context => ({\n  type: \"SPEAK\",\n  value: \"Repainting to \".concat(context.recResult)\n}));\n\nfunction say(text) {\n  return send(_context => ({\n    type: \"SPEAK\",\n    value: text\n  }));\n}\n\nfunction listen() {\n  return send('LISTEN');\n}\n\nexport const dmMachine = {\n  initial: 'init',\n  states: {\n    init: {\n      on: {\n        CLICK: 'who'\n      }\n    },\n    who: {\n      initial: \"prompt\",\n      on: {\n        RECOGNISED: [{\n          cond: context => parse(context.recResult.split(/\\s+/), gram).resultsForRule(gram.$root)[0] in gram,\n          target: \"ok\"\n        }, {\n          target: \".nomatch\"\n        }]\n      },\n      states: {\n        prompt: {\n          entry: say(\"What do you want to do?\"),\n          on: {\n            ENDSPEECH: \"ask\"\n          }\n        },\n        ask: {\n          entry: listen()\n        },\n        nomatch: {\n          entry: say(\"Sorry I don't understand\"),\n          on: {\n            ENDSPEECH: \"prompt\"\n          }\n        }\n      }\n    },\n    ok: {\n      initial: \"prompt\",\n      on: {\n        ENDSPEECH: \"init\"\n      },\n      states: {\n        prompt: {\n          entry: send(context => ({\n            type: \"SPEAK\",\n            value: \"OK. \".concat(context.person, \". On which day is your meeting?\")\n          }))\n        }\n      }\n    }\n  }\n};","map":{"version":3,"sources":["/mnt/c/users/justa/documents/assignment2/react-xstate-colourchanger/src/dmHome.ts"],"names":["send","actions","cancel","loadGrammar","parse","grammar","gram","result","split","resultsForRule","$root","console","log","sayColour","context","type","value","recResult","say","text","_context","listen","dmMachine","initial","states","init","on","CLICK","who","RECOGNISED","cond","target","prompt","entry","ENDSPEECH","ask","nomatch","ok","person"],"mappings":"AAAA,SAAwBA,IAAxB,EAAsCC,OAAtC,QAA6D,QAA7D;MACQC,M,GAAWD,O,CAAXC,M,EAER;;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,KAAT,QAAsB,eAAtB;AACA,SAASC,OAAT,QAAwB,wBAAxB,C,CACA;;AAEA,MAAMC,IAAI,GAAGH,WAAW,CAACE,OAAD,CAAxB,C,CACA;AACA;;AACA,MAAME,MAAM,GAAGH,KAAK,CAAE,kBAAD,CAAqBI,KAArB,CAA2B,KAA3B,CAAD,EAAoCF,IAApC,CAAL,CAA+CG,cAA/C,CAA8DH,IAAI,CAACI,KAAnE,EAA0E,CAA1E,CAAf;AAEAC,OAAO,CAACC,GAAR,CAAYL,MAAZ;AACAI,OAAO,CAACC,GAAR,CAAYN,IAAZ;AAEA,MAAMO,SAAuC,GAAGb,IAAI,CAAEc,OAAD,KAA0B;AAC3EC,EAAAA,IAAI,EAAE,OADqE;AAC5DC,EAAAA,KAAK,0BAAmBF,OAAO,CAACG,SAA3B;AADuD,CAA1B,CAAD,CAApD;;AAIA,SAASC,GAAT,CAAaC,IAAb,EAAyD;AACrD,SAAOnB,IAAI,CAAEoB,QAAD,KAA2B;AAAEL,IAAAA,IAAI,EAAE,OAAR;AAAiBC,IAAAA,KAAK,EAAEG;AAAxB,GAA3B,CAAD,CAAX;AACH;;AAED,SAASE,MAAT,GAAgD;AAC5C,SAAOrB,IAAI,CAAC,QAAD,CAAX;AACH;;AAGD,OAAO,MAAMsB,SAAmD,GAAI;AAChEC,EAAAA,OAAO,EAAE,MADuD;AAEhEC,EAAAA,MAAM,EAAE;AACJC,IAAAA,IAAI,EAAE;AACFC,MAAAA,EAAE,EAAE;AACAC,QAAAA,KAAK,EAAE;AADP;AADF,KADF;AAMJC,IAAAA,GAAG,EAAE;AACDL,MAAAA,OAAO,EAAE,QADR;AAEDG,MAAAA,EAAE,EAAE;AACAG,QAAAA,UAAU,EAAE,CAAC;AACTC,UAAAA,IAAI,EAAGhB,OAAD,IAAcV,KAAK,CAACU,OAAO,CAACG,SAAR,CAAkBT,KAAlB,CAAwB,KAAxB,CAAD,EAAiCF,IAAjC,CAAL,CAA4CG,cAA5C,CAA2DH,IAAI,CAACI,KAAhE,EAAuE,CAAvE,KAChBJ,IAFK;AAITyB,UAAAA,MAAM,EAAE;AAJC,SAAD,EAOZ;AAAEA,UAAAA,MAAM,EAAE;AAAV,SAPY;AADZ,OAFH;AAYDP,MAAAA,MAAM,EAAE;AACJQ,QAAAA,MAAM,EAAE;AACJC,UAAAA,KAAK,EAAEf,GAAG,CAAC,yBAAD,CADN;AAEJQ,UAAAA,EAAE,EAAE;AAAEQ,YAAAA,SAAS,EAAE;AAAb;AAFA,SADJ;AAKJC,QAAAA,GAAG,EAAE;AACDF,UAAAA,KAAK,EAAEZ,MAAM;AADZ,SALD;AAQJe,QAAAA,OAAO,EAAE;AACLH,UAAAA,KAAK,EAAEf,GAAG,CAAC,0BAAD,CADL;AAELQ,UAAAA,EAAE,EAAE;AAAEQ,YAAAA,SAAS,EAAE;AAAb;AAFC;AARL;AAZP,KAND;AAgCJG,IAAAA,EAAE,EAAE;AACAd,MAAAA,OAAO,EAAE,QADT;AAEAG,MAAAA,EAAE,EAAE;AAAEQ,QAAAA,SAAS,EAAE;AAAb,OAFJ;AAGAV,MAAAA,MAAM,EAAE;AACJQ,QAAAA,MAAM,EAAE;AACJC,UAAAA,KAAK,EAAEjC,IAAI,CAAEc,OAAD,KAAc;AACtBC,YAAAA,IAAI,EAAE,OADgB;AAEtBC,YAAAA,KAAK,gBAASF,OAAO,CAACwB,MAAjB;AAFiB,WAAd,CAAD;AADP;AADJ;AAHR;AAhCA;AAFwD,CAA7D","sourcesContent":["import { MachineConfig, send, Action, actions, assign } from \"xstate\";\r\nconst { cancel } = actions;\r\n\r\n// SRGS parser and example (logs the results to console on page load)\r\nimport { loadGrammar } from './runparser'\r\nimport { parse } from './chartparser'\r\nimport { grammar } from './grammars/homeGrammar'\r\n//import { cancel } from \"xstate/lib/actionTypes\";\r\n\r\nconst gram = loadGrammar(grammar)\r\n//const input = \"turn the A C off\"\r\n//const prs = parse(input.split(/\\s+/), gram)\r\nconst result = parse((\"turn the A C off\").split(/\\s+/), gram).resultsForRule(gram.$root)[0]\r\n\r\nconsole.log(result)\r\nconsole.log(gram)\r\n\r\nconst sayColour: Action<SDSContext, SDSEvent> = send((context: SDSContext) => ({\r\n    type: \"SPEAK\", value: `Repainting to ${context.recResult}`\r\n}))\r\n\r\nfunction say(text: string): Action<SDSContext, SDSEvent> {\r\n    return send((_context: SDSContext) => ({ type: \"SPEAK\", value: text }))\r\n}\r\n\r\nfunction listen(): Action<SDSContext, SDSEvent> {\r\n    return send('LISTEN')\r\n}\r\n\r\n\r\nexport const dmMachine: MachineConfig<SDSContext, any, SDSEvent> = ({\r\n    initial: 'init',\r\n    states: {\r\n        init: {\r\n            on: {\r\n                CLICK: 'who'\r\n            }\r\n        },\r\n        who: {\r\n            initial: \"prompt\",\r\n            on: {\r\n                RECOGNISED: [{\r\n                    cond: (context) => (parse(context.recResult.split(/\\s+/), gram).resultsForRule(gram.$root)[0]\r\n                     in gram),\r\n                    \r\n                    target: \"ok\"\r\n\r\n                },\r\n                { target: \".nomatch\" }]\r\n            },\r\n            states: {\r\n                prompt: {\r\n                    entry: say(\"What do you want to do?\"),\r\n                    on: { ENDSPEECH: \"ask\" }\r\n                },\r\n                ask: {\r\n                    entry: listen()\r\n                },\r\n                nomatch: {\r\n                    entry: say(\"Sorry I don't understand\"),\r\n                    on: { ENDSPEECH: \"prompt\" }\r\n                }\r\n            }\r\n        },\r\n        ok: {\r\n            initial: \"prompt\",\r\n            on: { ENDSPEECH: \"init\" },\r\n            states: {\r\n                prompt: {\r\n                    entry: send((context) => ({\r\n                        type: \"SPEAK\",\r\n                        value: `OK. ${context.person}. On which day is your meeting?`\r\n                    }))\r\n                },\r\n            }\r\n        }\r\n    }\r\n})"]},"metadata":{},"sourceType":"module"}